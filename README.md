# JPEG-JFIF 编解码器

一个符合JPEG-JFIF标准的编解码器实现，支持基本的编码/解码功能，包含SIMD和多线程优化。

## 功能特性

- 完整的JPEG-JFIF编解码功能
- 多线程处理支持（YUV各分量并行处理）
- 跨平台SIMD加速：
  - x86平台：SSE/AVX指令集
  - ARM平台：NEON指令集

## 当前限制

1. 仅支持YUV444采样格式
3. 未完全优化原生算法性能
4. 测试覆盖有限，可能存在兼容性问题

## 性能基准

测试图片：3200x2000分辨率图像（1.4MB JPG / 19MB YUV）

操作系统：Ubuntu 22.04 / MacOS Air

CPU：AMD R5 5600 / Apple Silicon M3

### 解码性能

| 优化方式            | 执行时间 | 用户CPU时间 | 系统CPU时间 | MD5校验值                   |
|---------------------|----------|-------------|-------------|-----------------------------|
| 无优化              | 43.83s   | 43.47s      | 0.35s       | 6a8baba370d2befa329d89a0910e7b1f |
| SSE加速             | 14.47s   | 14.11s      | 0.36s       | 224b56dc489e18d6e58f8ec1f2513a28 |
| AVX加速             | 13.15s   | 12.78s      | 0.35s       | 6817b350317285861969dcb57d2fc46a |
| 多线程(3线程)       | 23.48s   | 11.08s      | 1.41s       | 6a8baba370d2befa329d89a0910e7b1f |
| 多线程+AVX          | 11.71s   | 6.28s       | 2.40s       | 6817b350317285861969dcb57d2fc46a |
| 编译器优化(-O3)     | 6.84s    | 2.78s       | 2.73s       | -                           |
| NEON加速(-O3)       | 1.26s    | 1.19s       | 0.07s       | 3487fa421a85c7f7898ce22781d7c1d5 |

### 编码性能

| 优化方式            | 执行时间 | 用户CPU时间 | 系统CPU时间 | MD5校验值                   |
|---------------------|----------|-------------|-------------|-----------------------------|
| 无优化              | 49.93s   | 49.59s      | 0.34s       | 4ffd014f38bbaee96d2ef0e6cf4fcb3e |
| SSE加速             | 21.78s   | 21.43s      | 0.34s       | 57f22903b2f28531d1a689bbd429aebf |
| AVX加速             | 19.85s   | 19.50s      | 0.35s       | fc2973627fad10510cc5b862219f2155 |
| 多线程(3线程)       | 29.86s   | 17.34s      | 1.83s       | 4ffd014f38bbaee96d2ef0e6cf4fcb3e |
| 编译器优化(-O3)     | 6.78s    | 2.70s       | 2.79s       | -                           |
| NEON加速(-O3)       | 0.95s    | 0.87s       | 0.07s       | e5da63a91873dfe79cf2996b07a8e090 |

## 使用说明

### 基本命令

解码JPEG到YUV：
```bash
$ ./build/a.out -i test/lenna.jpg -o output.yuv
```

编码YUV到JPEG：
```bash
$ ./build/a.out -i output.yuv -s 512x512 -o output.jpg
```

## 开发路线

- [x] 项目模块化重构
- [x] 编码器功能实现
- [x] SIMD加速解码
- [x] 多线程支持
- [x] 自动检测架构选择SIMD指令集
- [x] 循环解码支持（暂不考虑）

## 注意事项

1. 不同优化方式产生的输出MD5可能不同，这是由浮点运算顺序差异导致的正常现象
2. 建议始终使用相同的优化配置进行编码/解码以获得一致的输出
